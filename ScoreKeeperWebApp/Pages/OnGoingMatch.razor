@page "/currentmatch"


<h3>OnGoingMatch</h3>
@currentMatch.Team1.TeamName
Scorer:
<PlayerSelect PlayerList="playersA" @bind-SelectedPlayer="scorer"></PlayerSelect>
Assist:
<PlayerSelect PlayerList="playersA" @bind-SelectedPlayer="assist"></PlayerSelect>

@currentMatch.Team2.TeamName
Scorer:
<PlayerSelect PlayerList="playersB" @bind-SelectedPlayer="scorer"></PlayerSelect>
Assist:
<PlayerSelect PlayerList="playersB" @bind-SelectedPlayer="assist"></PlayerSelect>



<RadzenButton Click=@(args => AddToScore()) Text="Add" Style="margin-bottom: 20px; width: 150px" />

<RadzenDataGrid @ref="dataGrid" AllowFiltering="true" AllowColumnResize="true" FilterMode="FilterMode.Advanced" AllowPaging="true" AllowSorting="true" Data="@matchScores" TItem="Score"
                ColumnWidth="300px" LogicalFilterOperator="LogicalFilterOperator.Or" Style="height:300px">
    <Columns>
        <RadzenDataGridColumn TItem="Score" Property="scorer" Filterable="false" Title="Scorer" Frozen="true" Width="50px" TextAlign="TextAlign.Center" />
        <RadzenDataGridColumn TItem="Score" Property="scorer" Title="Scorer" Frozen="true">
            <FooterTemplate>
                Total points: <b>@matchScores.Count()</b>
            </FooterTemplate>
        </RadzenDataGridColumn>
        <RadzenDataGridColumn TItem="Score" Property="assist" Title="Assist" Width="150px">
            <FooterTemplate>
                Footer
            </FooterTemplate>
        </RadzenDataGridColumn>
        <RadzenDataGridColumn TItem="Score" Property="DateTime" Title="Time" />

    </Columns>
</RadzenDataGrid>


@code {
    RadzenDataGrid<Score> dataGrid;
    public static Match currentMatch = MatchSetup.currentMatch;
    List<Player> playersA = currentMatch.Team1.Players;
    List<Player> playersB = currentMatch.Team2.Players;
    Player scorer;
    Player assist;
    Score score = new Score();
    List<Score> matchScores = new List<Score>();
    bool frozen;

    void OnChangeAScorer(object value)
    {
        scorer = playersA.Find(i => i.Name == value as string);
    }

    void OnChangeAAssist(object value)
    {
        assist = playersA.Find(i => i.Name == value as string);
    }

    void AddToScore()
    {
        score.Scorer = scorer;
        score.Assist = assist;
        score.DateTime = DateTime.Now;
        //text = $"{score.Scorer} scored with the help of {score.Assist} at {score.DateTime}";
        matchScores.Add(score);
        dataGrid.Reload();

    }

}
